# mangamuradl
mangamuradl - 最も手軽な漫画村ダウンロードツール

## ダウンロードと更新内容

windows(x64)ビルドは以下のリリースページの mangamuradl.zip から取得可能

https://github.com/internetisbroken/mangamuradl/releases

更新内容は上記URLに記載

## 対応一覧
- ページ画像の取得
    - jpg単独のページ
    - 分割されたページ(自動で結合される)
    - base64形式でエンコードされたページ(自動でデコードされる)
- ユーザがreCAPTCHAの操作を行うことで全ページの取得が可能
- PDF作成機能
- ZIP作成機能

## 準備

- Chrome ブラウザ

    ページリストの取得に Chrome ブラウザ（ChromeDriver）を使用するため、あらかじめ Chrome のインストールが必要。


## 使い方 (GUI)

1. mangamuradl-gui.exe を起動する
1. 右上の入力ボックスにpageid（URLまたは数字）を入力する(下記"pageid"参照)
1. 左上のStartボタンを押す
1. Chromeが起動し、自動でページリスト取得が行われる
    1. reCAPTCHA の認証が求められたた場合には、**ユーザー操作で** 認証を行うこと
    1. 動作中（特に初回起動時）ファイアウォールのメッセージが出る場合、キャンセル（不許可）で問題ない
    1. Chromeは自動で閉じるので、ブラウザを閉じたりリンクをクリックするなど、それ以外の操作が行われるとページリストの取得が失敗する
1. 実際に画像のダウンロードが行われる
    1. 動作中（特に初回起動時）ファイアウォールのメッセージが出る場合、キャンセル（不許可）で問題ない
1. 全ページが揃った場合、PDFが作成される（PDF作成機能ONの場合）
1. 全ページが揃った場合、ZIPが作成される（ZIP作成機能ONの場合）
1. 結果が下のテキストボックスに表示される
    1. 画像は「img/タイトル名/番号.jpg」
    1. PDFは「pdf/タイトル名.pdf」
    1. ZIPは「zip/タイトル名.pdf」

PDF/ZIP作成機能のスイッチは、"コマンドラインオプション"を参照

### pageid

以下のような感じを入力。
```
- hxxp://mangamura.org/?p=1234567890
- 1234567890
```

必要であればpageidの前後にスペースで区切ってオプションを付ける。
詳細は"コマンドラインオプション" 参照。

本プログラムは、コマンドライン版のラッパーなので、コマンドライン版の使い方も参照。

## mangamuradl の使い方 (コマンドライン)

Powershellかコマンドプロンプト等で

```
.\mangamuradl [options...] pageid
```

例：
```
.\mangamuradl 1234567890
```

実行した際の動作については、"使い方 (GUI)"の「Startボタンを押す」より後の流れと同じ。結果はコンソール画面に出力される。


### コマンドラインオプション

```
-h または --help    ヘルプを表示
-p または --pdf     PDF作成機能をオンに設定*
-P または --no-pdf  PDF作成機能をオフに設定(初期値)*
-z または --zip     ZIP作成機能をオンに設定(初期値)*
-Z または --no-zip  ZIP作成機能をオフに設定*

* 設定はiniファイルに保持される。
```

## 外部ツール

外部ツールでファイアウォールのメッセージが出る場合、キャンセル（不許可）で問題ない。

必要なプログラムは初回起動時に自動的にダウンロードして解凍される。

- convert (ImageMagick): pdf作成および分割ページの処理に必要
- phantomjs: 分割ページの処理に必要
- chromedriver, Chrome: ページリスト取得と認証ページの操作に必要
- uBlock Origin: Chrome起動時、広告等の遮断を行う
- 7za(7-Zip): zip作成に使用

## トラブルシュート

- 動作がおかしい時はmangamuradl.iniとdbフォルダを削除してみる
- リリースページを確認し最新版があれば更新する

#### 参考：似たようなツール

使用可能かどうか含め一切の詳細不明
- http://shimarisu.webcrow.jp/manga_mura.html
- https://9ketsuki.info/post-7907/
